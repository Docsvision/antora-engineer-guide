= Отключить проверку прав доступа для поискового запроса

Администратор может отключить проверку прав доступа для определённых поисковых запросов. Данная настройка является аналогом отключения проверки прав доступа на обычных папках. При отключении проверки прав для поиска с параметрами требуется дополнительно установить флаг `*Изменения на уровне БД*`, подробнее см. в разделе "xref:search-regen-disable.adoc[]".

Настройка должна выполняться администратором, быть включена на уровне базы данных, а также быть активирована индивидуально для каждого поискового запроса.

// [WARNING]
// ====
// Флаг `*Отключить проверку прав*` не может быть установлен для поисковых запросов, содержащих поисковые слова или параметр. Запрос можно отредактировать, добавив к нему поисковые слова или параметр, но после сохранения такого запроса флаг `*Отключить проверку прав*` будет сброшен.
// ====

.Чтобы отключить проверку прав доступа для поисковых запросов:
. В базе данных выполните настройки `DisableSecurityOnSearchAllowed = 1` и/или `DisableSecurityOnParameterSearchAllowed = 1` для таблицы `dvsys_settings`, чтобы запустить хранимую процедуру `dvsys_setting_set` с требуемыми параметрами. +
Выполните следующий запрос:
+
.Для {mssql}:
[source,sql]
----
declare @on bit = 1
exec dvsys_setting_set N'DisableSecurityOnSearchAllowed', @on
----
+
.Для {pgsql}:
[source,pgsql]
----
DO $$
declare val_value sql_variant = true::sql_variant;
BEGIN
  perform * from public."dvsys_setting_set"('DisableSecurityOnSearchAllowed', val_value);
END $$;
----
+
. Перезапустите *{sss-new}*.
. В РМА нажмите на кнопку *Расширенный поиск* image:buttons/magn-glass.png[Лупа], чтобы открыть редактор поисковых запросов.
. xref:search-new.adoc#query[Создайте новый поисковый запрос], нажмите *Сохранить как...*.
. В открывшемся окне введите название поискового запроса, в правой области, внизу поставьте флаг `*Отключить проверку прав*`, нажмите *Сохранить*.
+
.Создание нового поискового запроса
image::advanced-search-query.png[Создание нового поискового запроса]
+
****
.Проверка прав для результатов поискового запроса выполняется всегда, если:
* Для поискового запроса *не установлен* флаг `*Отключить проверку прав*`.

.Проверка прав для результатов поискового запроса не выполняется никогда, если соблюдены все следующие условия:
* Для поискового запроса *установлен* флаг `*Отключить проверку прав*`
* В БД выполнена настройка проверка прав `DisableSecurityOnParameterSearchAllowed`.
+
Настройка `DisableSecurityOnParameterSearchAllowed` позволяет отключить проверку прав также и на запросах без параметров.
+
* В БД задана настройка `DisableSecurityOnSearchAllowed`.
****
